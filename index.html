<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarkissian Luxury Studio - Bespoke Creation Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --gold-light: #F4E5B2;
            --gold-dark: #B8941F;
            --navy: #1E3A5F;
            --navy-light: #2C5282;
            --gray-dark: #2D3748;
            --gray-medium: #4A5568;
            --gray-light: #E2E8F0;
            --gray-lighter: #F7FAFC;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--gray-lighter);
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(30, 58, 95, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(212, 175, 55, 0.03) 0%, transparent 50%);
        }
        
        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }
        
        .luxury-gradient {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        }
        
        .navy-gradient {
            background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
        }
        
        .card-luxury {
            background: white;
            border: 1px solid var(--gold-light);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .card-luxury::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--gold) 0%, var(--gold-dark) 50%, var(--gold) 100%);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .btn-gold {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
            color: white;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-gold:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }
        
        .btn-navy {
            background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
            color: white;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        
        .btn-navy:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(30, 58, 95, 0.4);
        }
        
        .input-luxury {
            border: 1px solid var(--gray-light);
            background: var(--gray-lighter);
            transition: all 0.3s ease;
        }
        
        .input-luxury:focus {
            border-color: var(--gold);
            background: white;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        
        .select-luxury {
            border: 1px solid var(--gray-light);
            background: var(--gray-lighter);
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1.2em;
            padding-right: 2.5rem;
            transition: all 0.3s ease;
        }
        
        .select-luxury:focus {
            border-color: var(--gold);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        
        .loader-luxury {
            width: 50px;
            height: 50px;
            border: 3px solid var(--gold-light);
            border-radius: 50%;
            border-top-color: var(--gold);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .fade-in-luxury {
            animation: fadeInLuxury 0.8s ease-out;
        }
        
        @keyframes fadeInLuxury {
            from { 
                opacity: 0; 
                transform: translateY(20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .divider-gold {
            width: 60px;
            height: 3px;
            background: var(--gold);
            margin: 1rem 0;
        }
        
        .icon-luxury {
            color: var(--gold);
        }
        
        .result-card {
            border-left: 4px solid var(--gold);
            background: linear-gradient(to right, rgba(212, 175, 55, 0.05) 0%, white 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="navy-gradient text-white py-6 px-4 shadow-xl">
        <div class="container mx-auto max-w-6xl">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold tracking-wider">SARKISSIAN</h1>
                    <p class="text-gold-light text-sm tracking-widest mt-1">Luxury Studio</p>
                </div>
                <div class="flex items-center space-x-6">
                    <span class="text-sm opacity-80">EST. 2024</span>
                    <div class="w-px h-8 bg-gold opacity-50"></div>
                    <span class="text-sm opacity-80">BESPOKE CREATIONS</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Platform Status -->
        <div class="card-luxury rounded-lg p-6 mb-8 fade-in-luxury">
            <div class="flex flex-wrap items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Jewelry Creation Platform</h2>
                    <p class="text-gray-600">Seamless integration with production workflow</p>
                </div>
                <div class="flex flex-wrap gap-3 mt-4 lg:mt-0">
                    <span class="status-badge bg-green-100 text-green-800">
                        <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        Monday.com Active
                    </span>
                    <span class="status-badge bg-blue-100 text-blue-800">
                        <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                        Email System Ready
                    </span>
                    <span class="status-badge bg-purple-100 text-purple-800">
                        <span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>
                        Invoice Generator Online
                    </span>
                </div>
            </div>
        </div>

        <!-- Order Form -->
        <div class="card-luxury rounded-lg p-8 mb-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Create Bespoke Order</h2>
            <div class="divider-gold"></div>
            
            <form id="orderForm" class="space-y-8 mt-8">
                <!-- Customer Information -->
                <div>
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        Client Details
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="customerName" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" id="customerEmail" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contact Number</label>
                            <input type="tel" id="customerPhone" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Order Date</label>
                            <input type="date" id="orderDate" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" required>
                        </div>
                    </div>
                </div>

                <!-- Jewelry Specifications -->
                <div>
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        Jewelry Specifications
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jewelry Category</label>
                            <select id="jewelryType" class="w-full px-4 py-3 rounded-lg select-luxury appearance-none focus:outline-none" required>
                                <option value="">Select Category</option>
                                <option value="ER">Engagement Ring</option>
                                <option value="WB">Wedding Band</option>
                                <option value="Earring">Earrings</option>
                                <option value="Necklace">Necklace</option>
                                <option value="Bracelet">Bracelet</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Design Style</label>
                            <select id="ringType" class="w-full px-4 py-3 rounded-lg select-luxury appearance-none focus:outline-none">
                                <option value="">Select Style</option>
                                <option value="Solitaire">Solitaire</option>
                                <option value="Halo">Halo</option>
                                <option value="Bezel">Bezel Setting</option>
                                <option value="Three Stone">Three Stone</option>
                                <option value="Vintage">Vintage</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Stone Cut</label>
                            <select id="stoneShape" class="w-full px-4 py-3 rounded-lg select-luxury appearance-none focus:outline-none">
                                <option value="">Select Cut</option>
                                <option value="Round">Round Brilliant</option>
                                <option value="Princess">Princess</option>
                                <option value="Oval">Oval</option>
                                <option value="Emerald">Emerald</option>
                                <option value="Cushion">Cushion</option>
                                <option value="Pear">Pear</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Metal Selection</label>
                            <select id="metalType" class="w-full px-4 py-3 rounded-lg select-luxury appearance-none focus:outline-none" required>
                                <option value="">Select Metal</option>
                                <option value="14k White Gold">14k White Gold</option>
                                <option value="14k Yellow Gold">14k Yellow Gold</option>
                                <option value="14k Rose Gold">14k Rose Gold</option>
                                <option value="18k White Gold">18k White Gold</option>
                                <option value="18k Yellow Gold">18k Yellow Gold</option>
                                <option value="Platinum">Platinum</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ring Size</label>
                            <input type="number" id="ringSize" step="0.25" min="3" max="15" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" placeholder="e.g., 6.5">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Price (USD)</label>
                            <input type="number" id="price" step="0.01" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" placeholder="0.00" required>
                        </div>
                    </div>
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Special Instructions</label>
                        <textarea id="instructions" rows="3" class="w-full px-4 py-3 rounded-lg input-luxury focus:outline-none" placeholder="Any specific requirements or customizations..."></textarea>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4 pt-6">
                    <button type="submit" class="px-8 py-3 btn-gold rounded-lg text-white font-medium tracking-wide">
                        Process Order
                    </button>
                    <button type="button" onclick="resetDemo()" class="px-8 py-3 btn-navy rounded-lg text-white font-medium tracking-wide">
                        Reset Form
                    </button>
                </div>
            </form>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden space-y-6">
            <!-- File Matching Results -->
            <div class="card-luxury rounded-lg p-8 fade-in-luxury">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-3 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    CAD File Analysis Complete
                </h3>
                <div class="divider-gold"></div>
                <div id="fileResults" class="space-y-4 mt-6"></div>
            </div>

            <!-- Monday.com Integration -->
            <div class="card-luxury rounded-lg p-8 fade-in-luxury">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-3 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    Production Task Created
                </h3>
                <div class="divider-gold"></div>
                <div id="mondayResult" class="mt-6"></div>
            </div>

            <!-- Email Notification -->
            <div class="card-luxury rounded-lg p-8 fade-in-luxury">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-3 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    </svg>
                    Email Confirmations Sent
                </h3>
                <div class="divider-gold"></div>
                <div id="emailResult" class="space-y-4 mt-6"></div>
            </div>

            <!-- Invoice Generation -->
            <div class="card-luxury rounded-lg p-8 fade-in-luxury">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-3 icon-luxury" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Invoice Documentation
                </h3>
                <div class="divider-gold"></div>
                <div id="invoiceResult" class="mt-6"></div>
            </div>
        </div>

        <!-- Loading Modal -->
        <div id="loadingSpinner" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
            <div class="bg-white p-10 rounded-lg shadow-2xl text-center">
                <div class="loader-luxury mx-auto mb-6"></div>
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Processing Your Order</h3>
                <p class="text-gray-600">Creating your bespoke jewelry experience...</p>
            </div>
        </div>
    </div>

    <!-- Configuration Modal for API Keys -->
    <div id="configModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-2xl max-w-md w-full">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">API Configuration</h3>
            <p class="text-gray-600 mb-6">Enter your API credentials to enable live features:</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Monday.com API Key</label>
                    <input type="password" id="mondayApiKey" class="w-full px-4 py-2 rounded-lg input-luxury focus:outline-none" placeholder="Your Monday.com API key">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Monday.com Board ID</label>
                    <input type="text" id="mondayBoardId" class="w-full px-4 py-2 rounded-lg input-luxury focus:outline-none" placeholder="Your board ID">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">SMTP Email</label>
                    <input type="email" id="smtpEmail" class="w-full px-4 py-2 rounded-lg input-luxury focus:outline-none" placeholder="your-email@gmail.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">SMTP Password</label>
                    <input type="password" id="smtpPassword" class="w-full px-4 py-2 rounded-lg input-luxury focus:outline-none" placeholder="App-specific password">
                </div>
            </div>
            
            <div class="flex gap-4 mt-6">
                <button onclick="saveConfig()" class="px-6 py-2 btn-gold rounded-lg text-white font-medium">
                    Save Configuration
                </button>
                <button onclick="closeConfig()" class="px-6 py-2 btn-navy rounded-lg text-white font-medium">
                    Use Demo Mode
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        let apiConfig = {
            backendUrl: 'http://localhost:5000', // Change this to your server URL
            mondayApiKey: localStorage.getItem('mondayApiKey') || '',
            mondayBoardId: localStorage.getItem('mondayBoardId') || '',
            smtpEmail: localStorage.getItem('smtpEmail') || '',
            smtpPassword: localStorage.getItem('smtpPassword') || ''
        };

        // Global variables
        let currentOrder = {};
        
        // Mock CAD files database
        const mockCADFiles = [
            { filename: 'er_sol_rou_14k_mil.3dm', directory: 'ER/solitaire', score: 95, size: '2.4 MB' },
            { filename: 'er_sol_rou_14k_pln.3dm', directory: 'ER/solitaire', score: 90, size: '2.2 MB' },
            { filename: 'er_hal_rou_14k_pav.3dm', directory: 'ER/halo', score: 85, size: '3.1 MB' },
            { filename: 'wb_cls_14k_pln.3dm', directory: 'WB/classic', score: 88, size: '1.8 MB' },
            { filename: 'ear_rou_14k_pln.3dm', directory: 'Earring/studs', score: 92, size: '1.2 MB' }
        ];

        // Set today's date as default
        document.getElementById('orderDate').valueAsDate = new Date();

        // Check if API keys are configured on load
        window.onload = function() {
            if (!apiConfig.mondayApiKey && !apiConfig.smtpEmail) {
                // Show configuration modal for first-time users
                // document.getElementById('configModal').classList.remove('hidden');
            }
        };

        // Form submission handler
        document.getElementById('orderForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading spinner
            document.getElementById('loadingSpinner').classList.remove('hidden');
            
            // Collect form data
            currentOrder = {
                orderNumber: 'ORD-' + Date.now(),
                customerName: document.getElementById('customerName').value,
                customerEmail: document.getElementById('customerEmail').value,
                customerPhone: document.getElementById('customerPhone').value,
                orderDate: document.getElementById('orderDate').value,
                jewelryType: document.getElementById('jewelryType').value,
                ringType: document.getElementById('ringType').value,
                stoneShape: document.getElementById('stoneShape').value,
                metalType: document.getElementById('metalType').value,
                ringSize: document.getElementById('ringSize').value,
                price: parseFloat(document.getElementById('price').value),
                instructions: document.getElementById('instructions').value,
                timestamp: new Date().toISOString()
            };

            try {
                // Try to call backend API if configured
                if (apiConfig.mondayApiKey || apiConfig.smtpEmail) {
                    await processOrderWithBackend();
                } else {
                    // Use demo mode
                    await simulateProcessing();
                    showDemoResults();
                }
            } catch (error) {
                console.error('Error processing order:', error);
                // Fallback to demo mode
                await simulateProcessing();
                showDemoResults();
            }
            
            // Hide loading spinner
            document.getElementById('loadingSpinner').classList.add('hidden');
        });

        async function processOrderWithBackend() {
            try {
                const response = await fetch(`${apiConfig.backendUrl}/api/process-order`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiConfig.mondayApiKey
                    },
                    body: JSON.stringify({
                        order: currentOrder,
                        config: {
                            mondayBoardId: apiConfig.mondayBoardId,
                            smtpEmail: apiConfig.smtpEmail,
                            smtpPassword: apiConfig.smtpPassword
                        }
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showLiveResults(result);
                } else {
                    throw new Error('Backend API error');
                }
            } catch (error) {
                throw error;
            }
        }

        async function simulateProcessing() {
            // Simulate API calls with delays
            await new Promise(resolve => setTimeout(resolve, 2000));
        }

        function showDemoResults() {
            // Show results section
            document.getElementById('resultsSection').classList.remove('hidden');
            
            // Scroll to results
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            
            // Display demo results
            displayFileMatches();
            displayMondayResult();
            displayEmailResults();
            displayInvoiceResult();
        }

        function showLiveResults(apiResult) {
            // Show results section
            document.getElementById('resultsSection').classList.remove('hidden');
            
            // Scroll to results
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            
            // Display live results from API
            displayFileMatches(apiResult.fileMatches);
            displayMondayResult(apiResult.mondayTask);
            displayEmailResults(apiResult.emails);
            displayInvoiceResult(apiResult.invoice);
        }

        function displayFileMatches(matches = null) {
            const fileResultsDiv = document.getElementById('fileResults');
            const jewelryType = currentOrder.jewelryType.toLowerCase();
            
            // Use provided matches or generate mock ones
            if (!matches) {
                matches = mockCADFiles.filter(file => 
                    file.filename.toLowerCase().includes(jewelryType) ||
                    file.directory.toLowerCase().includes(jewelryType)
                ).slice(0, 3);
                
                if (matches.length === 0) {
                    matches = mockCADFiles.slice(0, 3);
                }
            }
            
            fileResultsDiv.innerHTML = `
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <p class="text-sm text-gray-600">Generated Filename:</p>
                    <code class="text-lg font-mono text-navy-light">${generateFilename()}</code>
                </div>
                <div class="space-y-3">
                    ${matches.map((file, index) => `
                        <div class="result-card rounded-lg p-4 ${index === 0 ? 'border-gold' : ''}">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="font-semibold text-gray-800">${file.filename}</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        <span class="font-medium">Location:</span> ${file.directory} 
                                        <span class="mx-2">•</span>
                                        <span class="font-medium">Size:</span> ${file.size}
                                    </p>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-gold">${file.score}%</div>
                                    <p class="text-xs text-gray-600">Match Score</p>
                                    ${index === 0 ? '<span class="inline-block mt-2 px-3 py-1 bg-gold text-white text-xs rounded-full">BEST MATCH</span>' : ''}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function generateFilename() {
            const abbrev = {
                'ER': 'er', 'WB': 'wb', 'Earring': 'ear', 'Necklace': 'nck', 'Bracelet': 'brc',
                'Solitaire': 'sol', 'Halo': 'hal', 'Bezel': 'bez',
                'Round': 'rou', 'Princess': 'pri', 'Oval': 'ovl',
                '14k White Gold': '14kw', '14k Yellow Gold': '14ky', '14k Rose Gold': '14kr',
                '18k White Gold': '18kw', '18k Yellow Gold': '18ky', 'Platinum': 'pt'
            };
            
            const parts = [];
            if (currentOrder.jewelryType) parts.push(abbrev[currentOrder.jewelryType] || currentOrder.jewelryType.toLowerCase().substr(0, 3));
            if (currentOrder.ringType) parts.push(abbrev[currentOrder.ringType] || currentOrder.ringType.toLowerCase().substr(0, 3));
            if (currentOrder.stoneShape) parts.push(abbrev[currentOrder.stoneShape] || currentOrder.stoneShape.toLowerCase().substr(0, 3));
            if (currentOrder.metalType) parts.push(abbrev[currentOrder.metalType] || currentOrder.metalType.toLowerCase());
            
            return parts.join('_') + '.3dm';
        }

        function displayMondayResult(taskData = null) {
            const mondayDiv = document.getElementById('mondayResult');
            const taskId = taskData?.id || 'TASK-' + Math.floor(Math.random() * 100000);
            const assignedTo = taskData?.assignedTo || 'John Smith (CAD Designer)';
            
            mondayDiv.innerHTML = `
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <p class="text-lg font-semibold text-gray-800">Task Created Successfully</p>
                            <p class="text-gray-600 mt-1">Task ID: <span class="font-mono">${taskId}</span></p>
                        </div>
                        <a href="${taskData?.url || '#'}" class="btn-navy px-4 py-2 rounded text-sm">
                            View in Monday.com →
                        </a>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Board</p>
                            <p class="font-medium">Jewelry Production 2024</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Status</p>
                            <p class="font-medium text-green-600">New Order</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Assigned To</p>
                            <p class="font-medium">${assignedTo}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Due Date</p>
                            <p class="font-medium">${new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toLocaleDateString()}</p>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4">
                        <p class="text-sm font-medium text-gray-700 mb-2">Task Details:</p>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>• Customer: ${currentOrder.customerName}</li>
                            <li>• Order: ${currentOrder.orderNumber}</li>
                            <li>• Specifications: ${currentOrder.jewelryType} - ${currentOrder.metalType}</li>
                            <li>• Priority: ${currentOrder.price > 5000 ? 'High' : 'Normal'}</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function displayEmailResults(emailData = null) {
            const emailDiv = document.getElementById('emailResult');
            const emails = emailData || [
                { to: currentOrder.customerEmail, subject: `Order Confirmation - ${currentOrder.orderNumber}`, status: 'sent' },
                { to: 'production@SARKISSIAN.com', subject: `New Production Order - ${currentOrder.orderNumber}`, status: 'sent' },
                { to: 'admin@SARKISSIAN.com', subject: `High Value Order Alert - $${currentOrder.price.toFixed(2)}`, status: 'sent' }
            ];
            
            emailDiv.innerHTML = `
                <div class="space-y-3">
                    ${emails.map((email, index) => `
                        <div class="bg-gray-50 rounded-lg p-4 border-l-4 ${index === 0 ? 'border-blue-500' : index === 1 ? 'border-purple-500' : 'border-gold'}">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="font-medium text-gray-800">${index === 0 ? 'Customer Confirmation' : index === 1 ? 'Production Team' : 'Management Alert'}</p>
                                    <p class="text-sm text-gray-600 mt-1">To: ${email.to}</p>
                                    <p class="text-sm text-gray-600">Subject: ${email.subject}</p>
                                </div>
                                <div class="ml-4">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                        </svg>
                                        Sent
                                    </span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="mt-6 bg-white border rounded-lg p-4">
                    <p class="text-sm font-medium text-gray-700 mb-2">Email Preview:</p>
                    <div class="text-sm text-gray-600 space-y-2">
                        <p>Dear ${currentOrder.customerName},</p>
                        <p>Thank you for choosing SARKISSIAN Luxury Jewelry. We're delighted to confirm receipt of your order for a bespoke ${currentOrder.jewelryType}.</p>
                        <p><strong>Order Details:</strong><br>
                        Order Number: ${currentOrder.orderNumber}<br>
                        Design: ${currentOrder.ringType || 'Custom'} in ${currentOrder.metalType}<br>
                        ${currentOrder.stoneShape ? `Stone: ${currentOrder.stoneShape} cut<br>` : ''}
                        Total: $${currentOrder.price.toFixed(2)}</p>
                        <p>Our master craftsmen will begin creating your unique piece immediately. You can expect delivery within 14-21 business days.</p>
                        <p>Best regards,<br>The SARKISSIAN Team</p>
                    </div>
                </div>
            `;
        }

        function displayInvoiceResult(invoiceData = null) {
            const invoiceDiv = document.getElementById('invoiceResult');
            const subtotal = currentOrder.price;
            const tax = subtotal * 0.08;
            const total = subtotal + tax;
            
            invoiceDiv.innerHTML = `
                <div class="bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-lg mb-4">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-lg font-semibold text-gray-800">Invoice Summary</p>
                            <p class="text-sm text-gray-600">Invoice #: ${invoiceData?.invoiceNumber || 'INV-' + currentOrder.orderNumber.substring(4)}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-gray-600">Date</p>
                            <p class="font-medium">${new Date().toLocaleDateString()}</p>
                        </div>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex justify-between py-2">
                            <span class="text-gray-600">Subtotal:</span>
                            <span class="font-medium">$${subtotal.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between py-2">
                            <span class="text-gray-600">Tax (8%):</span>
                            <span class="font-medium">$${tax.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between py-3 border-t border-gray-300">
                            <span class="text-lg font-semibold">Total Due:</span>
                            <span class="text-lg font-bold text-gold">$${total.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="downloadInvoice()" class="flex-1 px-4 py-2 btn-gold rounded text-sm font-medium">
                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            Download PDF
                        </button>
                        <button onclick="previewInvoice()" class="flex-1 px-4 py-2 btn-navy rounded text-sm font-medium">
                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                            Preview
                        </button>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <p class="text-sm text-blue-800">
                        <strong>Payment Instructions:</strong> A 50% deposit is required to begin production. 
                        The remaining balance is due upon completion. We accept wire transfers, certified checks, 
                        and major credit cards.
                    </p>
                </div>
            `;
        }

        function downloadInvoice() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add luxury styling to PDF
            doc.setDrawColor(212, 175, 55); // Gold color
            doc.setLineWidth(0.5);
            doc.line(20, 10, 190, 10);
            doc.line(20, 290, 190, 290);
            
            // Header
            doc.setFontSize(24);
            doc.setFont(undefined, 'bold');
            doc.text('SARKISSIAN', 105, 25, { align: 'center' });
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('LUXURY JEWELRY ATELIER', 105, 32, { align: 'center' });
            
            // Invoice title
            doc.setFontSize(18);
            doc.text('INVOICE', 105, 45, { align: 'center' });
            
            // Company info
            doc.setFontSize(10);
            doc.text('SARKISSIAN Luxury Jewelry', 20, 60);
            doc.text('123 Diamond Street', 20, 65);
            doc.text('Jewelry City, JC 12345', 20, 70);
            doc.text('Phone: (555) 123-4567', 20, 75);
            doc.text('Email: info@SARKISSIAN.com', 20, 80);
            
            // Invoice details
            const invoiceNum = 'INV-' + currentOrder.orderNumber.substring(4);
            doc.text(`Invoice #: ${invoiceNum}`, 120, 65);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 120, 70);
            doc.text(`Due Date: ${new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toLocaleDateString()}`, 120, 75);
            
            // Customer info
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('Bill To:', 20, 95);
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            doc.text(currentOrder.customerName, 20, 102);
            doc.text(currentOrder.customerEmail, 20, 107);
            if (currentOrder.customerPhone) {
                doc.text(currentOrder.customerPhone, 20, 112);
            }
            
            // Items table with luxury styling
            const tableData = [
                [
                    `Bespoke ${currentOrder.jewelryType}`,
                    `${currentOrder.metalType}${currentOrder.stoneShape ? ', ' + currentOrder.stoneShape + ' cut' : ''}${currentOrder.ringSize ? ', Size ' + currentOrder.ringSize : ''}`,
                    '1',
                    `$${currentOrder.price.toFixed(2)}`,
                    `$${currentOrder.price.toFixed(2)}`
                ]
            ];
            
            doc.autoTable({
                startY: 125,
                head: [['Item', 'Description', 'Qty', 'Price', 'Total']],
                body: tableData,
                theme: 'grid',
                headStyles: { 
                    fillColor: [30, 58, 95], // Navy color
                    textColor: [212, 175, 55], // Gold text
                    fontSize: 11
                },
                styles: {
                    cellPadding: 5,
                    fontSize: 10
                }
            });
            
            // Totals with luxury formatting
            const finalY = doc.lastAutoTable.finalY + 10;
            const subtotal = currentOrder.price;
            const tax = subtotal * 0.08;
            const total = subtotal + tax;
            
            // Draw totals box
            doc.setDrawColor(212, 175, 55);
            doc.rect(115, finalY - 5, 75, 35);
            
            doc.text(`Subtotal:`, 120, finalY);
            doc.text(`$${subtotal.toFixed(2)}`, 185, finalY, { align: 'right' });
            
            doc.text(`Tax (8%):`, 120, finalY + 7);
            doc.text(`$${tax.toFixed(2)}`, 185, finalY + 7, { align: 'right' });
            
            doc.setFont(undefined, 'bold');
            doc.setFontSize(12);
            doc.text(`Total:`, 120, finalY + 17);
            doc.text(`$${total.toFixed(2)}`, 185, finalY + 17, { align: 'right' });
            
            // Special instructions
            if (currentOrder.instructions) {
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                doc.text('Special Instructions:', 20, finalY + 35);
                const splitText = doc.splitTextToSize(currentOrder.instructions, 170);
                doc.text(splitText, 20, finalY + 42);
            }
            
            // Footer
            doc.setFontSize(9);
            doc.setTextColor(100);
            doc.text('Thank you for choosing Sarkissian Luxury Studio', 105, 275, { align: 'center' });
            doc.text('Payment terms: 50% deposit required, balance due upon completion', 105, 280, { align: 'center' });
            
            // Save the PDF
            doc.save(`${invoiceNum}_SARKISSIAN.pdf`);
        }

        function previewInvoice() {
            // Create a preview window with luxury styling
            const previewWindow = window.open('', '_blank', 'width=800,height=900');
            const subtotal = currentOrder.price;
            const tax = subtotal * 0.08;
            const total = subtotal + tax;
            const invoiceNum = 'INV-' + currentOrder.orderNumber.substring(4);
            
            const invoiceHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Invoice - ${invoiceNum} | SARKISSIAN</title>
                    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
                    <style>
                        body { 
                            font-family: 'Montserrat', sans-serif; 
                            margin: 0;
                            padding: 40px;
                            background: #f8f9fa;
                        }
                        .invoice-container {
                            max-width: 800px;
                            margin: 0 auto;
                            background: white;
                            padding: 60px;
                            box-shadow: 0 0 20px rgba(0,0,0,0.1);
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 50px;
                            border-top: 3px solid #D4AF37;
                            border-bottom: 3px solid #D4AF37;
                            padding: 30px 0;
                        }
                        .header h1 {
                            font-family: 'Playfair Display', serif;
                            font-size: 36px;
                            margin: 0;
                            color: #1E3A5F;
                            letter-spacing: 3px;
                        }
                        .header p {
                            margin: 5px 0 0 0;
                            color: #D4AF37;
                            letter-spacing: 2px;
                            font-size: 12px;
                        }
                        .invoice-details {
                            display: flex;
                            justify-content: space-between;
                            margin-bottom: 40px;
                        }
                        .company-info, .invoice-info {
                            flex: 1;
                        }
                        .invoice-info {
                            text-align: right;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 30px 0;
                        }
                        th {
                            background: #1E3A5F;
                            color: #D4AF37;
                            padding: 15px;
                            text-align: left;
                            font-weight: 500;
                            letter-spacing: 0.5px;
                        }
                        td {
                            padding: 20px 15px;
                            border-bottom: 1px solid #e0e0e0;
                        }
                        .totals {
                            text-align: right;
                            margin-top: 30px;
                        }
                        .totals-box {
                            display: inline-block;
                            border: 2px solid #D4AF37;
                            padding: 20px 30px;
                            background: #faf8f3;
                        }
                        .total-line {
                            display: flex;
                            justify-content: space-between;
                            margin: 10px 0;
                            min-width: 250px;
                        }
                        .total-final {
                            font-size: 20px;
                            font-weight: 600;
                            color: #1E3A5F;
                            border-top: 2px solid #D4AF37;
                            padding-top: 10px;
                            margin-top: 10px;
                        }
                        .footer {
                            text-align: center;
                            margin-top: 60px;
                            padding-top: 30px;
                            border-top: 1px solid #e0e0e0;
                            color: #666;
                            font-size: 12px;
                        }
                        .luxury-text {
                            color: #D4AF37;
                            font-weight: 500;
                        }
                    </style>
                </head>
                <body>
                    <div class="invoice-container">
                        <div class="header">
                            <h1>Sarkissian</h1>
                            <p>Luxury Studio</p>
                        </div>
                        
                        <h2 style="text-align: center; font-family: 'Playfair Display', serif; color: #1E3A5F; font-size: 28px; margin-bottom: 40px;">INVOICE</h2>
                        
                        <div class="invoice-details">
                            <div class="company-info">
                                <p style="font-weight: 600; color: #1E3A5F; margin-bottom: 10px;">FROM:</p>
                                <p><strong>Sarkissian Luxury Studio</strong><br>
                                123 Test Test<br>
                                Test City, JC 12345<br>
                                Phone: (555) 123-4567<br>
                                Email: info@SARKISSIAN.com</p>
                            </div>
                            <div class="invoice-info">
                                <p><strong>Invoice #:</strong> <span class="luxury-text">${invoiceNum}</span><br>
                                <strong>Date:</strong> ${new Date().toLocaleDateString()}<br>
                                <strong>Due Date:</strong> ${new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toLocaleDateString()}<br>
                                <strong>Status:</strong> <span style="color: #D4AF37;">Pending</span></p>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <p style="font-weight: 600; color: #1E3A5F; margin-bottom: 10px;">BILL TO:</p>
                            <p>${currentOrder.customerName}<br>
                            ${currentOrder.customerEmail}<br>
                            ${currentOrder.customerPhone || ''}</p>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Description</th>
                                    <th style="text-align: center;">Qty</th>
                                    <th style="text-align: right;">Price</th>
                                    <th style="text-align: right;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Bespoke ${currentOrder.jewelryType}</strong></td>
                                    <td>${currentOrder.metalType}${currentOrder.stoneShape ? ', ' + currentOrder.stoneShape + ' cut' : ''}${currentOrder.ringSize ? '<br>Size: ' + currentOrder.ringSize : ''}</td>
                                    <td style="text-align: center;">1</td>
                                    <td style="text-align: right;">$${currentOrder.price.toFixed(2)}</td>
                                    <td style="text-align: right;"><strong>$${currentOrder.price.toFixed(2)}</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        ${currentOrder.instructions ? `
                            <div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-left: 3px solid #D4AF37;">
                                <p style="font-weight: 600; color: #1E3A5F; margin-bottom: 10px;">Special Instructions:</p>
                                <p style="color: #666;">${currentOrder.instructions}</p>
                            </div>
                        ` : ''}
                        
                        <div class="totals">
                            <div class="totals-box">
                                <div class="total-line">
                                    <span>Subtotal:</span>
                                    <span>$${subtotal.toFixed(2)}</span>
                                </div>
                                <div class="total-line">
                                    <span>Tax (8%):</span>
                                    <span>$${tax.toFixed(2)}</span>
                                </div>
                                <div class="total-line total-final">
                                    <span>Total Due:</span>
                                    <span>$${total.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="footer">
                            <p style="font-size: 14px; color: #1E3A5F; margin-bottom: 20px;">
                                Thank you for choosing <span class="luxury-text">SARKISSIAN Luxury Jewelry</span>
                            </p>
                            <p>Payment Terms: 50% deposit required to begin production<br>
                            Balance due upon completion<br>
                            We accept wire transfers, certified checks, and major credit cards</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            previewWindow.document.write(invoiceHTML);
            previewWindow.document.close();
        }

        function resetDemo() {
            // Reset form
            document.getElementById('orderForm').reset();
            document.getElementById('orderDate').valueAsDate = new Date();
            
            // Hide results
            document.getElementById('resultsSection').classList.add('hidden');
            
            // Clear current order
            currentOrder = {};
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function saveConfig() {
            // Save API configuration
            apiConfig.mondayApiKey = document.getElementById('mondayApiKey').value;
            apiConfig.mondayBoardId = document.getElementById('mondayBoardId').value;
            apiConfig.smtpEmail = document.getElementById('smtpEmail').value;
            apiConfig.smtpPassword = document.getElementById('smtpPassword').value;
            
            // Save to localStorage
            localStorage.setItem('mondayApiKey', apiConfig.mondayApiKey);
            localStorage.setItem('mondayBoardId', apiConfig.mondayBoardId);
            localStorage.setItem('smtpEmail', apiConfig.smtpEmail);
            localStorage.setItem('smtpPassword', apiConfig.smtpPassword);
            
            // Close modal
            document.getElementById('configModal').classList.add('hidden');
            
            alert('Configuration saved! The platform will now use live integrations.');
        }

        function closeConfig() {
            document.getElementById('configModal').classList.add('hidden');
        }
    </script>
</body>
</html>